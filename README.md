# elecom_nsb3_openwrt_bb
Writing the later in Japanase.

ELECOM社の法人向けNAS製品 NSB-3NR/3MS シリーズ向けOpenWrt 14.07 (BB = Barrier Breaker)です．

ELECOM社から開示されたソースコード一式のうちLinuxカーネルをOpenWrt 14.07ツリーでビルドできるように合わせ込んだ成果物です．<BR>
ビルドされるuserlandはOSSのOpenWrtそのものであり，当然ながら製品のファームウェアに搭載されている独自ソフトウェアの部分は一切含みません．<BR>

<BR>
BBベースとしてあるのはカーネルのリビジョンが近いOSS OpenWrtのリリースを検討した結果です．<BR>
OpenWrtは最新でなくなったリリースに対して一切更新をしないのでBBは既にobsoleteなリビジョンですがハードウェアに載っているペリフェラルを一通り動かせるかどうかの実証目的で手始めに移植の対象にしました．<BR>
<BR>
このリポジトリは今後ほぼ更新する予定はありませんのでご承知おき下さい．<BR>
今後はCS75xx向けの差分を最新に近いカーネルへ移植していく作業のフェーズに移行します．<BR>

<BR>
target/linux/cs75xx/ が今回移植にあたって新設したプラットフォーム用のディレクトリです．<BR>

<BR>
製品ファームウェアのカーネルとの違いは下記の通りです．

1) スイッチHUBコントローラ RTL8367RB を利用可能<BR>
   製品説明で「使いません」とされているLANポート 3個をswconfig対応のスイッチHUBとして使えます．<BR>
   port VLANも利用可<BR>

2) 前面の液晶を /dev/i2c-1 にアドレス 0x3Cで見えるようにしてあります<BR>
   よくある制御仕様のOLEDだそうなので，使いたい方はuserlandのプログラムを導入するなりして下さい

3) 温度によるファン制御を行うセンサーチップ AMC6821 を amc6821ドライバに紐づけしてあります．<BR>
   カーネルに含まれるSoC用のI2Cドライバはまともに動作しない品質だったので，i2c-gpioを使うように変更してあります．<BR>
   1ドライブモデル(NSB-3NR)にはファンが搭載されていないので，動作は未確認です．

4) ボタン類(POWERボタンを除く)をOpenWrt標準のhotplugイベント対応ボタンとして利用可能

5) LEDをLinux標準のLEDデバイスとして利用可能

<BR>
なお，有線Ethernetポートは<BR>
eth0: 製品ファームウェアでサポートされているWANポート(USBポートに近い1個)<BR>
eth1: 製品説明で「使いません」とされている3連装のポート => スイッチHUB<BR>
が，ギガビット対応で2系統使えます．<BR>
設定次第で有線ルータ兼NASとして使うこともできます．<BR>

<BR>
serial-ATA (内蔵HDDのインターフェース)，USBポートについては動作未確認です．
